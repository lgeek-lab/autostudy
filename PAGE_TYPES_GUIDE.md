# 📄 智能页面类型识别指南

## 🎯 功能概述

插件现已支持智能页面类型识别，能够自动检测当前页面类型并执行相应的学习策略：

- 📝 **文本页面**：正常滚动浏览内容
- 🎥 **视频页面**：自动播放视频（静音+倍速）
- 📁 **文件列表页面**：逐个查看文件内容

## 🔍 页面类型检测

### 📝 文本页面
**特征：** 普通的文档内容、文章、说明页面
**处理方式：** 
- 从页面顶部开始滚动
- 滚动到底部后点击"下一个"按钮
- 继续下一页面

### 🎥 视频页面  
**特征：** 包含 `<video>` 标签或视频iframe
**处理方式：**
- 自动检测视频元素
- 设置静音播放
- 调整播放倍速（默认2倍）
- 等待视频播放完成
- 自动点击"下一个"按钮

### 📁 文件列表页面
**特征：** 包含多个"查看"、"预览"、"打开"按钮或文件下载链接
**处理方式：**
- 检测所有"查看"按钮
- 逐个点击查看文件
- 滚动文件内容到底部
- 点击右上角叉号关闭
- 继续下一个文件
- 所有文件查看完成后点击"下一页"

## 🛠️ 检测算法详情

### 视频检测
```javascript
// 检测标准video元素
document.querySelectorAll('video')

// 检测视频iframe  
document.querySelectorAll('iframe[src*="player"], iframe[src*="video"]')
```

### 文件列表检测
```javascript
// 检测查看按钮
text.includes('查看') || text.includes('预览') || text.includes('打开')

// 检测文件链接
/\.(pdf|doc|docx|ppt|pptx|xls|xlsx|zip|rar|txt)$/i

// 检测表格结构
'table tbody tr', '.file-list', '.document-list'
```

### 关闭按钮检测
```javascript
// 标准关闭按钮
'.close', '.btn-close', '[data-dismiss="modal"]'

// 右上角×按钮
text === '×' || text === '✕' || text === 'X'
```

## ⚙️ 配置选项

### 文件列表处理控制
- **设置项**：自动处理文件列表
- **默认值**：启用
- **说明**：关闭后，文件列表页面将按文本页面处理

### 其他相关设置
- **页面加载等待**：文件切换间等待时间
- **视频播放倍速**：视频自动调速设置
- **最大重试次数**：按钮查找失败时重试

## 🎮 使用场景示例

### 场景1：混合内容课程
```
文本介绍页 → 视频讲解页 → 文件资料页 → 练习页面 → 下一章节
   ↓           ↓           ↓           ↓
 滚动浏览    视频播放    逐个查看    滚动浏览
```

### 场景2：资料库浏览
```
文件列表页面
├── PDF文档1 → 自动查看 → 滚动 → 关闭
├── PPT文档2 → 自动查看 → 滚动 → 关闭  
├── Word文档3 → 自动查看 → 滚动 → 关闭
└── 完成后自动进入下一页
```

### 场景3：视频课程
```
课程目录 → 视频1(静音2倍速) → 视频2 → 视频3 → 测试页面
    ↓            ↓            ↓        ↓         ↓
  滚动浏览    等待播放完成   自动播放  自动播放   滚动浏览
```

## 🔧 故障排除

### 页面类型识别错误
**问题**：页面被识别为错误类型  
**解决**：
1. 检查页面DOM结构是否符合检测条件
2. 查看浏览器控制台的检测日志
3. 可临时关闭"自动处理文件列表"强制按文本处理

### 文件列表处理问题
**问题**：无法找到查看按钮或关闭按钮  
**解决**：
1. 确保按钮包含"查看"、"预览"、"打开"等关键词
2. 检查按钮是否可见且可点击
3. 查看控制台日志了解具体识别情况

### 视频处理问题
**问题**：视频未自动播放或倍速设置无效  
**解决**：
1. 某些视频需要用户手动点击播放
2. 检查视频元素是否标准的HTML5 video
3. 调整"视频播放倍速"设置

## 📊 调试信息

插件会在浏览器控制台输出详细的检测和处理日志：

```
[AutoStudy] 开始检测页面类型...
[AutoStudy] 检测到 2 个video元素, 0 个视频iframe  
[AutoStudy] 页面类型：视频
[AutoStudy] 根据页面类型处理: video
[AutoStudy] 检测到视频页面，开始视频处理...
```

## 💡 使用建议

1. **首次使用**：建议保持所有选项为默认状态进行测试
2. **特殊页面**：如遇到识别错误的页面，可临时手动控制
3. **网络环境**：网络较慢时适当增加"页面加载等待"时间
4. **自定义需求**：可根据具体课程平台的特点调整检测条件

---

**享受全自动的智能学习体验！** 🚀
